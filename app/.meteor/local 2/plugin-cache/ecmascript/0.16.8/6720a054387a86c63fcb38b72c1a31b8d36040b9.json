{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/phatca/Documents/GitHub/professor-trading-card/app/packages/montiapm:agent/lib/hijack/mongo_driver_events.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.x86_64"},"sourceFileName":"packages/montiapm:agent/lib/hijack/mongo_driver_events.js","filename":"/Users/phatca/Documents/GitHub/professor-trading-card/app/packages/montiapm:agent/lib/hijack/mongo_driver_events.js","targets":{},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/phatca/Documents/GitHub/professor-trading-card/app","root":"/Users/phatca/Documents/GitHub/professor-trading-card/app","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/phatca/Documents/GitHub/professor-trading-card/app/packages/montiapm:agent/lib/hijack/mongo_driver_events.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/montiapm:agent/lib/hijack/mongo_driver_events.js"}},"code":"module.export({\n  getMongoDriverStats: () => getMongoDriverStats,\n  resetMongoDriverStats: () => resetMongoDriverStats\n});\nlet Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor(v) {\n    Meteor = v;\n  }\n}, 0);\nlet MongoInternals;\nmodule.link(\"meteor/mongo\", {\n  MongoInternals(v) {\n    MongoInternals = v;\n  }\n}, 1);\nlet client;\nlet serverStatus = Object.create(null);\nlet otherCheckouts = 0;\n\n// These metrics are only for the mongo pool for the primary Mongo server\nlet primaryCheckouts = 0;\nlet totalCheckoutTime = 0;\nlet maxCheckoutTime = 0;\nlet created = 0;\nlet measurementCount = 0;\nlet pendingTotal = 0;\nlet checkedOutTotal = 0;\nsetInterval(() => {\n  let status = getServerStatus(getPrimary(), true);\n  if (status) {\n    pendingTotal += status.pending.length;\n    checkedOutTotal += status.checkedOut.size;\n    measurementCount += 1;\n  }\n}, 1000);\n\n// Version 4 of the driver defaults to 100. Older versions used 10.\nlet DEFAULT_MAX_POOL_SIZE = 100;\nfunction getPoolSize() {\n  if (client && client.topology && client.topology.s && client.topology.s.options) {\n    return client.topology.s.options.maxPoolSize || DEFAULT_MAX_POOL_SIZE;\n  }\n  return 0;\n}\nfunction getMongoDriverStats() {\n  return {\n    poolSize: getPoolSize(),\n    primaryCheckouts,\n    otherCheckouts,\n    checkoutTime: totalCheckoutTime,\n    maxCheckoutTime,\n    pending: pendingTotal ? pendingTotal / measurementCount : 0,\n    checkedOut: checkedOutTotal ? checkedOutTotal / measurementCount : 0,\n    created\n  };\n}\nfunction resetMongoDriverStats() {\n  primaryCheckouts = 0;\n  otherCheckouts = 0;\n  totalCheckoutTime = 0;\n  maxCheckoutTime = 0;\n  pendingTotal = 0;\n  checkedOutTotal = 0;\n  measurementCount = 0;\n  primaryCheckouts = 0;\n  created = 0;\n}\nMeteor.startup(() => {\n  let _client = MongoInternals.defaultRemoteCollectionDriver().mongo.client;\n  if (!_client || !_client.s) {\n    // Old version of agent\n    return;\n  }\n  let options = _client.s.options || {};\n  let versionParts = MongoInternals.NpmModules.mongodb.version.split('.').map(part => parseInt(part, 10));\n\n  // Version 4 of the driver removed the option and enabled it by default\n  if (!options.useUnifiedTopology && versionParts[0] < 4) {\n    // CMAP and topology monitoring requires useUnifiedTopology\n    return;\n  }\n\n  // Meteor 1.9 enabled useUnifiedTopology, but CMAP events were only added\n  // in version 3.5 of the driver.\n  if (versionParts[0] === 3 && versionParts[1] < 5) {\n    return;\n  }\n  client = _client;\n\n  // Get the number of connections already created\n  let primaryDescription = getServerDescription(getPrimary());\n  if (primaryDescription && primaryDescription.s && primaryDescription.s.pool) {\n    let pool = primaryDescription.s.pool;\n    let totalConnections = pool.totalConnectionCount;\n    let availableConnections = pool.availableConnectionCount;\n\n    // totalConnectionCount counts available connections twice\n    created += totalConnections - availableConnections;\n  }\n  client.on('connectionCreated', event => {\n    let primary = getPrimary();\n    if (primary === event.address) {\n      created += 1;\n    }\n  });\n  client.on('connectionClosed', event => {\n    let status = getServerStatus(event.address, true);\n    if (status) {\n      status.checkedOut.delete(event.connectionId);\n    }\n  });\n  client.on('connectionCheckOutStarted', event => {\n    let status = getServerStatus(event.address);\n    status.pending.push(event.time);\n  });\n  client.on('connectionCheckOutFailed', event => {\n    let status = getServerStatus(event.address, true);\n    if (status) {\n      status.pending.shift();\n    }\n  });\n  client.on('connectionCheckedOut', event => {\n    let status = getServerStatus(event.address);\n    let start = status.pending.shift();\n    let primary = getPrimary();\n    if (start && primary === event.address) {\n      let checkoutDuration = event.time.getTime() - start.getTime();\n      primaryCheckouts += 1;\n      totalCheckoutTime += checkoutDuration;\n      if (checkoutDuration > maxCheckoutTime) {\n        maxCheckoutTime = checkoutDuration;\n      }\n    } else {\n      otherCheckouts += 1;\n    }\n    status.checkedOut.add(event.connectionId);\n  });\n  client.on('connectionCheckedIn', event => {\n    let status = getServerStatus(event.address, true);\n    if (status) {\n      status.checkedOut.delete(event.connectionId);\n    }\n  });\n  client.on('serverClosed', function (event) {\n    delete serverStatus[event.address];\n  });\n});\nfunction getServerStatus(address, disableCreate) {\n  if (typeof address !== 'string') {\n    return null;\n  }\n  if (address in serverStatus) {\n    return serverStatus[address];\n  }\n  if (disableCreate) {\n    return null;\n  }\n  serverStatus[address] = {\n    pending: [],\n    checkedOut: new Set()\n  };\n  return serverStatus[address];\n}\nfunction getPrimary() {\n  if (!client || !client.topology) {\n    return null;\n  }\n  // The driver renamed lastIsMaster in version 4.3.1 to lastHello\n  let server = client.topology.lastIsMaster ? client.topology.lastIsMaster() : client.topology.lastHello();\n  if (server.type === 'Standalone') {\n    return server.address;\n  }\n  if (!server || !server.primary) {\n    return null;\n  }\n  return server.primary;\n}\nfunction getServerDescription(address) {\n  if (!client || !client.topology || !client.topology.s || !client.topology.s.servers) {\n    return null;\n  }\n  let description = client.topology.s.servers.get(address);\n  return description || null;\n}","map":{"version":3,"names":["module","export","getMongoDriverStats","resetMongoDriverStats","Meteor","link","v","MongoInternals","client","serverStatus","Object","create","otherCheckouts","primaryCheckouts","totalCheckoutTime","maxCheckoutTime","created","measurementCount","pendingTotal","checkedOutTotal","setInterval","status","getServerStatus","getPrimary","pending","length","checkedOut","size","DEFAULT_MAX_POOL_SIZE","getPoolSize","topology","s","options","maxPoolSize","poolSize","checkoutTime","startup","_client","defaultRemoteCollectionDriver","mongo","versionParts","NpmModules","mongodb","version","split","map","part","parseInt","useUnifiedTopology","primaryDescription","getServerDescription","pool","totalConnections","totalConnectionCount","availableConnections","availableConnectionCount","on","event","primary","address","delete","connectionId","push","time","shift","start","checkoutDuration","getTime","add","disableCreate","Set","server","lastIsMaster","lastHello","type","servers","description","get"],"sources":["packages/montiapm:agent/lib/hijack/mongo_driver_events.js"],"sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { MongoInternals } from 'meteor/mongo';\n\nlet client;\nlet serverStatus = Object.create(null);\n\nlet otherCheckouts = 0;\n\n// These metrics are only for the mongo pool for the primary Mongo server\nlet primaryCheckouts = 0;\nlet totalCheckoutTime = 0;\nlet maxCheckoutTime = 0;\nlet created = 0;\nlet measurementCount = 0;\nlet pendingTotal = 0;\nlet checkedOutTotal = 0;\n\nsetInterval(() => {\n  let status = getServerStatus(getPrimary(), true);\n\n  if (status) {\n    pendingTotal += status.pending.length;\n    checkedOutTotal += status.checkedOut.size;\n    measurementCount += 1;\n  }\n}, 1000);\n\n// Version 4 of the driver defaults to 100. Older versions used 10.\nlet DEFAULT_MAX_POOL_SIZE = 100;\n\nfunction getPoolSize () {\n  if (client && client.topology && client.topology.s && client.topology.s.options) {\n    return client.topology.s.options.maxPoolSize || DEFAULT_MAX_POOL_SIZE;\n  }\n\n  return 0;\n}\n\nexport function getMongoDriverStats () {\n  return {\n    poolSize: getPoolSize(),\n    primaryCheckouts,\n    otherCheckouts,\n    checkoutTime: totalCheckoutTime,\n    maxCheckoutTime,\n    pending: pendingTotal ? pendingTotal / measurementCount : 0,\n    checkedOut: checkedOutTotal ? checkedOutTotal / measurementCount : 0,\n    created\n  };\n}\n\nexport function resetMongoDriverStats () {\n  primaryCheckouts = 0;\n  otherCheckouts = 0;\n  totalCheckoutTime = 0;\n  maxCheckoutTime = 0;\n  pendingTotal = 0;\n  checkedOutTotal = 0;\n  measurementCount = 0;\n  primaryCheckouts = 0;\n  created = 0;\n}\n\nMeteor.startup(() => {\n  let _client = MongoInternals.defaultRemoteCollectionDriver().mongo.client;\n\n  if (!_client || !_client.s) {\n    // Old version of agent\n    return;\n  }\n\n  let options = _client.s.options || {};\n  let versionParts = MongoInternals.NpmModules.mongodb.version.split('.')\n    .map(part => parseInt(part, 10));\n\n  // Version 4 of the driver removed the option and enabled it by default\n  if (!options.useUnifiedTopology && versionParts[0] < 4) {\n    // CMAP and topology monitoring requires useUnifiedTopology\n    return;\n  }\n\n  // Meteor 1.9 enabled useUnifiedTopology, but CMAP events were only added\n  // in version 3.5 of the driver.\n  if (versionParts[0] === 3 && versionParts[1] < 5) {\n    return;\n  }\n\n  client = _client;\n\n  // Get the number of connections already created\n  let primaryDescription = getServerDescription(getPrimary());\n  if (primaryDescription && primaryDescription.s && primaryDescription.s.pool) {\n    let pool = primaryDescription.s.pool;\n    let totalConnections = pool.totalConnectionCount;\n    let availableConnections = pool.availableConnectionCount;\n\n    // totalConnectionCount counts available connections twice\n    created += totalConnections - availableConnections;\n  }\n\n  client.on('connectionCreated', event => {\n    let primary = getPrimary();\n    if (primary === event.address) {\n      created += 1;\n    }\n  });\n\n  client.on('connectionClosed', event => {\n    let status = getServerStatus(event.address, true);\n    if (status) {\n      status.checkedOut.delete(event.connectionId);\n    }\n  });\n\n  client.on('connectionCheckOutStarted', event => {\n    let status = getServerStatus(event.address);\n    status.pending.push(event.time);\n  });\n\n  client.on('connectionCheckOutFailed', event => {\n    let status = getServerStatus(event.address, true);\n    if (status) {\n      status.pending.shift();\n    }\n  });\n\n  client.on('connectionCheckedOut', event => {\n    let status = getServerStatus(event.address);\n    let start = status.pending.shift();\n    let primary = getPrimary();\n\n    if (start && primary === event.address) {\n      let checkoutDuration = event.time.getTime() - start.getTime();\n\n      primaryCheckouts += 1;\n      totalCheckoutTime += checkoutDuration;\n      if (checkoutDuration > maxCheckoutTime) {\n        maxCheckoutTime = checkoutDuration;\n      }\n    } else {\n      otherCheckouts += 1;\n    }\n\n    status.checkedOut.add(event.connectionId);\n  });\n\n  client.on('connectionCheckedIn', event => {\n    let status = getServerStatus(event.address, true);\n    if (status) {\n      status.checkedOut.delete(event.connectionId);\n    }\n  });\n\n  client.on('serverClosed', function (event) {\n    delete serverStatus[event.address];\n  });\n});\n\nfunction getServerStatus (address, disableCreate) {\n  if (typeof address !== 'string') {\n    return null;\n  }\n\n  if (address in serverStatus) {\n    return serverStatus[address];\n  }\n\n  if (disableCreate) {\n    return null;\n  }\n\n  serverStatus[address] = {\n    pending: [],\n    checkedOut: new Set(),\n  };\n\n  return serverStatus[address];\n}\n\nfunction getPrimary () {\n  if (!client || !client.topology) {\n    return null;\n  }\n  // The driver renamed lastIsMaster in version 4.3.1 to lastHello\n  let server = client.topology.lastIsMaster ?\n    client.topology.lastIsMaster() :\n    client.topology.lastHello();\n\n  if (server.type === 'Standalone') {\n    return server.address;\n  }\n\n  if (!server || !server.primary) {\n    return null;\n  }\n\n  return server.primary;\n}\n\nfunction getServerDescription (address) {\n  if (!client || !client.topology || !client.topology.s || !client.topology.s.servers) {\n    return null;\n  }\n  let description = client.topology.s.servers.get(address);\n\n  return description || null;\n}\n"],"mappings":"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"},"sourceType":"module","externalDependencies":{},"hash":"6720a054387a86c63fcb38b72c1a31b8d36040b9"}
