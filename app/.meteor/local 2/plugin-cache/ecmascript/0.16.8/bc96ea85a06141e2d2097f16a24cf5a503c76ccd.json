{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/phatca/Documents/GitHub/professor-trading-card/app/packages/montiapm:meteorx/src/fiberless/mongo.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.x86_64"},"sourceFileName":"packages/montiapm:meteorx/src/fiberless/mongo.js","filename":"/Users/phatca/Documents/GitHub/professor-trading-card/app/packages/montiapm:meteorx/src/fiberless/mongo.js","targets":{},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/phatca/Documents/GitHub/professor-trading-card/app","root":"/Users/phatca/Documents/GitHub/professor-trading-card/app","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/phatca/Documents/GitHub/professor-trading-card/app/packages/montiapm:meteorx/src/fiberless/mongo.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/montiapm:meteorx/src/fiberless/mongo.js"}},"code":"module.export({\n  exposeMongoAsync: () => exposeMongoAsync\n});\nlet Mongo, MongoInternals;\nmodule.link(\"meteor/mongo\", {\n  Mongo(v) {\n    Mongo = v;\n  },\n  MongoInternals(v) {\n    MongoInternals = v;\n  }\n}, 0);\nfunction exposeMongoAsync(MeteorX) {\n  return Promise.asyncApply(() => {\n    let MongoInternals;\n    module.link(\"meteor/mongo\", {\n      MongoInternals(v) {\n        MongoInternals = v;\n      }\n    }, 1);\n    if (!MeteorX._mongoInstalled) return;\n    const coll = _getDummyCollection();\n    Promise.await(coll.findOneAsync());\n    const driver = MongoInternals.defaultRemoteCollectionDriver();\n    MeteorX.MongoConnection = driver.mongo.constructor;\n    const cursor = coll.find();\n    MeteorX.MongoCursor = cursor.constructor;\n    Promise.await(exposeOplogDriver(MeteorX, coll));\n    Promise.await(exposePollingDriver(MeteorX, coll));\n    Promise.await(exposeMultiplexer(MeteorX, coll));\n    Promise.await(exposeSynchronousCursor(MeteorX, coll));\n  });\n}\nfunction _getDummyCollection() {\n  const Collection = typeof Mongo !== \"undefined\" ? Mongo.Collection : Meteor.Collection;\n  return new Collection(\"__dummy_coll_\" + Random.id());\n}\nfunction _getSynchronousCursor(cursor) {\n  return Promise.asyncApply(() => {\n    Promise.await(cursor.fetchAsync());\n    return cursor._synchronousCursor || undefined;\n  });\n}\nfunction _getMultiplexer(cursor) {\n  return Promise.asyncApply(() => {\n    const handler = Promise.await(cursor.observeChanges({\n      added: Function.prototype\n    }));\n    Promise.await(handler.stop());\n    return handler._multiplexer;\n  });\n}\nfunction _getObserverDriver(cursor) {\n  return Promise.asyncApply(() => {\n    const multiplexer = Promise.await(_getMultiplexer(cursor));\n    return multiplexer && multiplexer._observeDriver || undefined;\n  });\n}\nfunction exposeOplogDriver(namespace, coll) {\n  return Promise.asyncApply(() => {\n    const driver = Promise.await(_getObserverDriver(coll.find({})));\n    // verify observer driver is an oplog driver\n    if (driver && typeof driver.constructor.cursorSupported === \"function\") {\n      namespace.MongoOplogDriver = driver.constructor;\n    }\n  });\n}\nfunction exposePollingDriver(namespace, coll) {\n  return Promise.asyncApply(() => {\n    const cursor = coll.find({}, {\n      limit: 20,\n      _disableOplog: true\n    });\n    const driver = Promise.await(_getObserverDriver(cursor));\n    // verify observer driver is a polling driver\n    if (driver && typeof driver.constructor.cursorSupported === \"undefined\") {\n      namespace.MongoPollingDriver = driver.constructor;\n    }\n  });\n}\nfunction exposeSynchronousCursor(namespace, coll) {\n  return Promise.asyncApply(() => {\n    const synchronousCursor = Promise.await(_getSynchronousCursor(coll.find({})));\n    if (synchronousCursor) {\n      namespace.SynchronousCursor = synchronousCursor.constructor;\n    }\n  });\n}\nfunction exposeMultiplexer(namespace, coll) {\n  return Promise.asyncApply(() => {\n    const multiplexer = Promise.await(_getMultiplexer(coll.find({})));\n    if (multiplexer) {\n      namespace.Multiplexer = multiplexer.constructor;\n    }\n  });\n}","map":{"version":3,"names":["module","export","exposeMongoAsync","Mongo","MongoInternals","link","v","MeteorX","Promise","asyncApply","_mongoInstalled","coll","_getDummyCollection","await","findOneAsync","driver","defaultRemoteCollectionDriver","MongoConnection","mongo","constructor","cursor","find","MongoCursor","exposeOplogDriver","exposePollingDriver","exposeMultiplexer","exposeSynchronousCursor","Collection","Meteor","Random","id","_getSynchronousCursor","fetchAsync","_synchronousCursor","undefined","_getMultiplexer","handler","observeChanges","added","Function","prototype","stop","_multiplexer","_getObserverDriver","multiplexer","_observeDriver","namespace","cursorSupported","MongoOplogDriver","limit","_disableOplog","MongoPollingDriver","synchronousCursor","SynchronousCursor","Multiplexer"],"sources":["packages/montiapm:meteorx/src/fiberless/mongo.js"],"sourcesContent":["import { Mongo, MongoInternals } from \"meteor/mongo\";\n\nexport async function exposeMongoAsync(MeteorX) {\n  if (!MeteorX._mongoInstalled) return\n\n  import { MongoInternals } from \"meteor/mongo\";\n\n  const coll = _getDummyCollection();\n\n  await coll.findOneAsync();\n\n  const driver = MongoInternals.defaultRemoteCollectionDriver();\n\n  MeteorX.MongoConnection = driver.mongo.constructor;\n  const cursor = coll.find();\n  MeteorX.MongoCursor = cursor.constructor;\n\n  await exposeOplogDriver(MeteorX, coll);\n  await exposePollingDriver(MeteorX, coll);\n  await exposeMultiplexer(MeteorX, coll);\n  await exposeSynchronousCursor(MeteorX, coll);\n}\n\nfunction _getDummyCollection() {\n  const Collection = typeof Mongo !== \"undefined\" ? Mongo.Collection : Meteor.Collection;\n  return new Collection(\"__dummy_coll_\" + Random.id());\n}\n\nasync function _getSynchronousCursor(cursor) {\n  await cursor.fetchAsync();\n  return cursor._synchronousCursor || undefined;\n}\n\nasync function _getMultiplexer(cursor) {\n  const handler = await cursor.observeChanges({ added: Function.prototype });\n  await handler.stop();\n\n  return handler._multiplexer;\n}\n\nasync function _getObserverDriver(cursor) {\n  const multiplexer = await _getMultiplexer(cursor);\n\n  return multiplexer && multiplexer._observeDriver || undefined;\n}\n\nasync function exposeOplogDriver(namespace, coll) {\n  const driver = await _getObserverDriver(coll.find({}));\n  // verify observer driver is an oplog driver\n  if (driver && typeof driver.constructor.cursorSupported === \"function\") {\n    namespace.MongoOplogDriver = driver.constructor;\n  }\n}\n\nasync function exposePollingDriver(namespace, coll) {\n  const cursor = coll.find({}, { limit: 20, _disableOplog: true });\n  const driver = await _getObserverDriver(cursor);\n  // verify observer driver is a polling driver\n  if (driver && typeof driver.constructor.cursorSupported === \"undefined\") {\n    namespace.MongoPollingDriver = driver.constructor;\n  }\n}\n\nasync function exposeSynchronousCursor(namespace, coll) {\n  const synchronousCursor = await _getSynchronousCursor(coll.find({}));\n  if (synchronousCursor) {\n    namespace.SynchronousCursor = synchronousCursor.constructor;\n  }\n}\n\nasync function exposeMultiplexer(namespace, coll) {\n  const multiplexer = await _getMultiplexer(coll.find({}));\n\n  if (multiplexer) {\n    namespace.Multiplexer = multiplexer.constructor;\n  }\n}\n"],"mappings":"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"},"sourceType":"module","externalDependencies":{},"hash":"bc96ea85a06141e2d2097f16a24cf5a503c76ccd"}
