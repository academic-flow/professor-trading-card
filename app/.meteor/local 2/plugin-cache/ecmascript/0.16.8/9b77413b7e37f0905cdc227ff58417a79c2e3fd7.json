{"metadata":{},"options":{"assumptions":{},"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/phatca/Documents/GitHub/professor-trading-card/app/packages/montiapm:agent/lib/utils.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","objectRestSpread","objectRestSpread","asyncGenerators","classProperties","classPrivateProperties","jsx","nullishCoalescingOperator","nullishCoalescingOperator","optionalChaining","optionalChaining","optionalCatchBinding","optionalCatchBinding","classProperties","classPrivateProperties","classPrivateMethods","classProperties","classPrivateProperties","asyncGenerators","asyncGenerators","objectRestSpread","objectRestSpread","logicalAssignment"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"allowUndeclaredExports":true,"strictMode":false},"caller":{"name":"meteor","arch":"os.osx.x86_64"},"sourceFileName":"packages/montiapm:agent/lib/utils.js","filename":"/Users/phatca/Documents/GitHub/professor-trading-card/app/packages/montiapm:agent/lib/utils.js","targets":{},"cloneInputAst":true,"browserslistConfigFile":false,"passPerPreset":false,"envName":"development","cwd":"/Users/phatca/Documents/GitHub/professor-trading-card/app","root":"/Users/phatca/Documents/GitHub/professor-trading-card/app","rootMode":"root","plugins":[{"key":"base$0","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"base$0$0","visitor":{"Program":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true},"options":{"avoidModernSyntax":false,"enforceStrictMode":false,"dynamicImport":true,"generateLetDeclarations":true},"externalDependencies":[]},{"key":"transform-runtime","visitor":{"MemberExpression":{"enter":[null]},"ObjectPattern":{"enter":[null]},"BinaryExpression":{"enter":[null]},"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"version":"7.17.2","helpers":true,"useESModules":false,"corejs":false},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{"loose":true},"externalDependencies":[]},{"key":"transform-react-jsx","visitor":{"JSXNamespacedName":{"enter":[null]},"JSXSpreadChild":{"enter":[null]},"Program":{"enter":[null]},"JSXFragment":{"exit":[null]},"JSXElement":{"exit":[null]},"JSXAttribute":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","runtime":"classic","throwIfNamespace":true,"useBuiltIns":false},"externalDependencies":[]},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-react-pure-annotations","visitor":{"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-nullish-coalescing-operator","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-nullish-coalescing-operator","visitor":{"LogicalExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-chaining","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-chaining","visitor":{"OptionalCallExpression":{"enter":[null]},"OptionalMemberExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-optional-catch-binding","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-optional-catch-binding","visitor":{"CatchClause":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-class-properties","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-class-properties","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ClassExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-async-generator-functions","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-object-rest-spread","visitor":{"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ArrayPattern":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"proposal-logical-assignment-operators","visitor":{"AssignmentExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{},"externalDependencies":[]},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{},"externalDependencies":[]}],"presets":[],"generatorOpts":{"filename":"/Users/phatca/Documents/GitHub/professor-trading-card/app/packages/montiapm:agent/lib/utils.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/montiapm:agent/lib/utils.js"}},"code":"module.export({\n  haveAsyncCallback: () => haveAsyncCallback,\n  UniqueId: () => UniqueId,\n  DefaultUniqueId: () => DefaultUniqueId,\n  CreateUserStack: () => CreateUserStack,\n  OptimizedApply: () => OptimizedApply,\n  getClientVersions: () => getClientVersions,\n  countKeys: () => countKeys,\n  iterate: () => iterate,\n  getProperty: () => getProperty,\n  createHistogram: () => createHistogram,\n  pick: () => pick\n});\nlet getClientArchVersion;\nmodule.link(\"./common/utils\", {\n  getClientArchVersion(v) {\n    getClientArchVersion = v;\n  }\n}, 0);\nconst {\n  DDSketch\n} = require('monti-apm-sketches-js');\nfunction haveAsyncCallback(args) {\n  const lastArg = args[args.length - 1];\n  return typeof lastArg === 'function';\n}\nclass UniqueId {\n  constructor() {\n    this.id = 0;\n  }\n  get() {\n    return \"\".concat(this.id++);\n  }\n}\nconst DefaultUniqueId = new UniqueId();\nfunction CreateUserStack(error) {\n  const stack = (error || new Error()).stack.split('\\n');\n  let toRemove = 1;\n\n  // Find how many frames need to be removed\n  // to make the user's code the first frame\n  for (; toRemove < stack.length; toRemove++) {\n    if (stack[toRemove].indexOf('montiapm:agent') === -1) {\n      break;\n    }\n  }\n  return stack.slice(toRemove).join('\\n');\n}\nfunction OptimizedApply(context, fn, args) {\n  let a = args;\n  switch (a.length) {\n    case 0:\n      return fn.call(context);\n    case 1:\n      return fn.call(context, a[0]);\n    case 2:\n      return fn.call(context, a[0], a[1]);\n    case 3:\n      return fn.call(context, a[0], a[1], a[2]);\n    case 4:\n      return fn.call(context, a[0], a[1], a[2], a[3]);\n    case 5:\n      return fn.call(context, a[0], a[1], a[2], a[3], a[4]);\n    default:\n      return fn.apply(context, a);\n  }\n}\nfunction getClientVersions() {\n  return {\n    'web.cordova': getClientArchVersion('web.cordova'),\n    'web.browser': getClientArchVersion('web.browser'),\n    'web.browser.legacy': getClientArchVersion('web.browser.legacy')\n  };\n}\nfunction countKeys(obj) {\n  if (obj instanceof Map || obj instanceof Set) {\n    return obj.size;\n  }\n  return Object.keys(obj).length;\n}\nfunction iterate(obj, callback) {\n  if (obj instanceof Map) {\n    return obj.forEach(callback);\n  }\n\n  // eslint-disable-next-line guard-for-in\n  for (let key in obj) {\n    let value = obj[key];\n    callback(value, key);\n  }\n}\nfunction getProperty(obj, key) {\n  if (obj instanceof Map) {\n    return obj.get(key);\n  }\n  return obj[key];\n}\nfunction createHistogram() {\n  return new DDSketch({\n    alpha: 0.02\n  });\n}\nfunction pick(obj, keys) {\n  return keys.reduce((result, key) => {\n    if (obj[key] !== undefined) {\n      result[key] = obj[key];\n    }\n    return result;\n  }, {});\n}","map":{"version":3,"names":["module","export","haveAsyncCallback","UniqueId","DefaultUniqueId","CreateUserStack","OptimizedApply","getClientVersions","countKeys","iterate","getProperty","createHistogram","pick","getClientArchVersion","link","v","DDSketch","require","args","lastArg","length","constructor","id","get","concat","error","stack","Error","split","toRemove","indexOf","slice","join","context","fn","a","call","apply","obj","Map","Set","size","Object","keys","callback","forEach","key","value","alpha","reduce","result","undefined"],"sources":["packages/montiapm:agent/lib/utils.js"],"sourcesContent":["import { getClientArchVersion } from './common/utils';\n\nconst { DDSketch } = require('monti-apm-sketches-js');\n\nexport function haveAsyncCallback (args) {\n  const lastArg = args[args.length - 1];\n\n  return typeof lastArg === 'function';\n}\n\nexport class UniqueId {\n  constructor () {\n    this.id = 0;\n  }\n\n  get () {\n    return `${this.id++}`;\n  }\n}\n\nexport const DefaultUniqueId = new UniqueId();\n\n// creates a stack trace, removing frames in montiapm:agent's code\nexport function CreateUserStack (error) {\n  const stack = (error || new Error()).stack.split('\\n');\n  let toRemove = 1;\n\n  // Find how many frames need to be removed\n  // to make the user's code the first frame\n  for (; toRemove < stack.length; toRemove++) {\n    if (stack[toRemove].indexOf('montiapm:agent') === -1) {\n      break;\n    }\n  }\n\n  return stack.slice(toRemove).join('\\n');\n}\n\n// Optimized version of apply which tries to call as possible as it can\n// Then fall back to apply\n// This is because, v8 is very slow to invoke apply.\nexport function OptimizedApply (context, fn, args) {\n  let a = args;\n  switch (a.length) {\n    case 0:\n      return fn.call(context);\n    case 1:\n      return fn.call(context, a[0]);\n    case 2:\n      return fn.call(context, a[0], a[1]);\n    case 3:\n      return fn.call(context, a[0], a[1], a[2]);\n    case 4:\n      return fn.call(context, a[0], a[1], a[2], a[3]);\n    case 5:\n      return fn.call(context, a[0], a[1], a[2], a[3], a[4]);\n    default:\n      return fn.apply(context, a);\n  }\n}\n\nexport function getClientVersions () {\n  return {\n    'web.cordova': getClientArchVersion('web.cordova'),\n    'web.browser': getClientArchVersion('web.browser'),\n    'web.browser.legacy': getClientArchVersion('web.browser.legacy')\n  };\n}\n\n// Returns number of keys of an object, or size of a Map or Set\nexport function countKeys (obj) {\n  if (obj instanceof Map || obj instanceof Set) {\n    return obj.size;\n  }\n\n  return Object.keys(obj).length;\n}\n\n// Iterates objects and maps.\n// Callback is called with a value and key\nexport function iterate (obj, callback) {\n  if (obj instanceof Map) {\n    return obj.forEach(callback);\n  }\n\n  // eslint-disable-next-line guard-for-in\n  for (let key in obj) {\n    let value = obj[key];\n    callback(value, key);\n  }\n}\n\n// Returns a property from an object, or an entry from a map\nexport function getProperty (obj, key) {\n  if (obj instanceof Map) {\n    return obj.get(key);\n  }\n\n  return obj[key];\n}\n\nexport function createHistogram () {\n  return new DDSketch({\n    alpha: 0.02\n  });\n}\n\nexport function pick (obj, keys) {\n  return keys.reduce((result, key) => {\n    if (obj[key] !== undefined) {\n      result[key] = obj[key];\n    }\n    return result;\n  }, {});\n}\n"],"mappings":"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"},"sourceType":"module","externalDependencies":{},"hash":"9b77413b7e37f0905cdc227ff58417a79c2e3fd7"}
